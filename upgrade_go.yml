---
- hosts: all
  remote_user: root

  tasks:
    - lineinfile: dest=/etc/environment state=present line="export GOROOT=/usr/local/go"
    - lineinfile: dest=/etc/environment state=present line="export GOPATH=/data/pram"
    - lineinfile: dest=/etc/environment state=present line="export GOBIN=/data/pram/bin"
    - lineinfile: dest=/root/.profile state=present line="export PATH=$PATH:$GOROOT/bin"

    - file: path=/usr/local/go/ state=absent
    - file: path=/root/go.tar.gz state=absent

    - get_url:
        url: https://go.dev/dl/go1.20.5.linux-amd64.tar.gz
        dest: /root/go.tar.gz
        checksum: sha256:d7ec48cde0d3d2be2c69203bc3e0a44de8660b9c09a6e85c4732a3f7dc442612

    - unarchive: src=/root/go.tar.gz dest=/usr/local copy=no
